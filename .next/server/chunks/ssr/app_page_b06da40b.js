module.exports=[30100,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(3043),e=a.i(70106);let f=(0,e.default)("badge-check",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var g=a.i(96221),h=a.i(15618),i=a.i(81560),j=a.i(98621),k=a.i(98474);let l={High:"text-rose-600 bg-rose-50 border border-rose-100",Medium:"text-amber-600 bg-amber-50 border border-amber-100",Low:"text-emerald-600 bg-emerald-50 border border-emerald-100"};function m({project:a,teamMembers:d=[],onProjectUpdate:e,onTeamRefresh:m=()=>{}}){let[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)({name:"",assigneeId:"",priority:"Medium"}),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null);(0,c.useEffect)(()=>{let b=!1;return(async()=>{if(!a?._id)return o([]);q(!0);try{let c=await k.api.getTasks(a._id);b||o(c)}catch(a){console.error("Failed to load tasks",a)}finally{b||q(!1)}})(),()=>{b=!0}},[a?._id]);let x=(0,c.useMemo)(()=>({completed:n.filter(a=>"Complete"===a.status).length,total:n.length}),[n]),y=(a,b)=>{if(!a||!e)return;let c=b.filter(a=>"Complete"===a.status).length;e({...a,taskSummary:{total:b.length,completed:c}})},z=async b=>{if(b.preventDefault(),a?._id&&r.name.trim())try{u(!0);let b={name:r.name,projectId:a._id,assigneeId:r.assigneeId||void 0,priority:r.priority},{task:c,project:d}=await k.api.createTask(b);o(a=>{let b=[c,...a];return y(d,b),b}),m(),s({name:"",assigneeId:"",priority:"Medium"})}catch(a){console.error("Failed to create task",a)}finally{u(!1)}},A=async a=>{try{w(a._id);let b="Complete"===a.status?"Incomplete":"Complete",{task:c,project:d}=await k.api.toggleTaskStatus(a._id,b);o(b=>{let e=b.map(b=>b._id===a._id?c:b);return y(d,e),e}),m()}catch(a){console.error("Failed to toggle task",a)}finally{w(null)}},B=async a=>{try{w(a._id);let{project:b}=await k.api.deleteTask(a._id);o(c=>{let d=c.filter(b=>b._id!==a._id);return y(b,d),d}),m()}catch(a){console.error("Failed to delete task",a)}finally{w(null)}};return(0,b.jsxs)("section",{className:"surface-card space-y-5",children:[(0,b.jsxs)("header",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.35em] text-slate-400",children:"Tasks"}),(0,b.jsx)("h2",{className:"mt-2 text-2xl font-semibold text-slate-900",children:a?a.name:"Select a project"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:a?`Client deliverables due ${a.dueDate?new Date(a.dueDate).toLocaleDateString():"TBD"}.`:"Pick a project from the list to see and manage its tasks."})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 px-4 py-2 text-right",children:[(0,b.jsx)("p",{className:"text-[10px] uppercase tracking-[0.35em] text-slate-400",children:"Complete"}),(0,b.jsxs)("p",{className:"text-2xl font-semibold text-slate-900",children:[x.completed,"/",x.total]})]})]}),(0,b.jsxs)("form",{onSubmit:z,className:"grid gap-3 rounded-2xl border border-slate-200 bg-slate-50/60 p-4",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Task name",(0,b.jsx)("input",{placeholder:"Draft initial blueprints",value:r.name,onChange:a=>s(b=>({...b,name:a.target.value})),disabled:!a})]}),(0,b.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,b.jsxs)("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Priority",(0,b.jsx)("select",{value:r.priority,onChange:a=>s(b=>({...b,priority:a.target.value})),disabled:!a,children:["High","Medium","Low"].map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]}),(0,b.jsxs)("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Assignee",(0,b.jsxs)("select",{value:r.assigneeId,onChange:a=>s(b=>({...b,assigneeId:a.target.value})),disabled:!a,children:[(0,b.jsx)("option",{value:"",children:"Unassigned"}),d.map(a=>(0,b.jsx)("option",{value:a._id,children:a.name},a._id))]})]})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)("button",{type:"submit",className:"btn-primary",disabled:t||!a,children:[t?(0,b.jsx)(g.Loader2,{size:16,className:"animate-spin"}):(0,b.jsx)(h.Plus,{size:16}),t?"Adding":"Add task"]})})]}),(0,b.jsx)("div",{className:"space-y-3",children:p?(0,b.jsx)("div",{className:"flex h-32 items-center justify-center rounded-2xl border border-slate-200 bg-white text-slate-400",children:(0,b.jsx)(g.Loader2,{className:"animate-spin"})}):n.length?n.map(a=>(0,b.jsxs)("article",{className:"flex flex-wrap items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-4 py-3",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>A(a),className:(0,j.default)("rounded-full border p-1","Complete"===a.status?"border-emerald-400 bg-emerald-50 text-emerald-600":"border-slate-200 text-slate-400"),children:v===a._id?(0,b.jsx)(g.Loader2,{size:16,className:"animate-spin"}):(0,b.jsx)(f,{size:16})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:(0,j.default)("font-semibold","Complete"===a.status?"text-slate-400 line-through":"text-slate-900"),children:a.name}),(0,b.jsxs)("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[(0,b.jsxs)("span",{className:(0,j.default)("status-pill border px-3 py-1",l[a.priority]),children:[a.priority," priority"]}),(0,b.jsx)("span",{children:a.assignee?.name||"Unassigned"})]})]})]})}),(0,b.jsx)("button",{type:"button",onClick:()=>B(a),className:"rounded-full border border-slate-200 p-2 text-slate-400 hover:border-rose-200 hover:text-rose-500",disabled:v===a._id,children:(0,b.jsx)(i.Trash2,{size:16})})]},a._id)):(0,b.jsx)("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-white px-4 py-8 text-center text-slate-500",children:a?"No tasks for this project yet.":"Select a project to see its tasks."})})]})}var n=a.i(19429);let o=(0,e.default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),p=(0,e.default)("calendar-clock",[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]),q=(0,e.default)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);function r({projects:a=[],teamMembers:c=[]}){let d=Date.now(),e=d+6048e5,f=a.filter(a=>a?.dueDate&&new Date(a.dueDate).getTime()<d&&"Completed"!==a.status).sort((a,b)=>new Date(a.dueDate)-new Date(b.dueDate)),g=a.filter(a=>{if(!a?.dueDate||"Completed"===a.status)return!1;let b=new Date(a.dueDate).getTime();return b>=d&&b<=e}).sort((a,b)=>new Date(a.dueDate)-new Date(b.dueDate)),h=c.map(a=>({...a,computedWorkload:(a=>{if("number"==typeof a?.workload)return Math.round(a.workload);let b=a?.capacity||5;return Math.min(100,Math.round(((Array.isArray(a?.tasks)?a.tasks.length:a?.taskCount||0)||0)/b*100))})(a)})).filter(a=>a.computedWorkload>=90).sort((a,b)=>b.computedWorkload-a.computedWorkload),i=[{label:"Overdue briefs",value:f.length,icon:o,accent:"text-rose-600",tone:"bg-rose-50 border-rose-100"},{label:"Due this week",value:g.length,icon:p,accent:"text-amber-600",tone:"bg-amber-50 border-amber-100"},{label:"Capacity alerts",value:h.length,icon:q,accent:"text-blue-600",tone:"bg-blue-50 border-blue-100"}];return(0,b.jsxs)("section",{className:"surface-card space-y-5",children:[(0,b.jsxs)("header",{children:[(0,b.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.35em] text-slate-400",children:"Insights"}),(0,b.jsx)("h2",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"Studio pulse"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"auto-generated alerts from live project data."})]}),(0,b.jsx)("div",{className:"grid gap-3 sm:grid-cols-3",children:i.map(a=>{let c=a.icon;return(0,b.jsxs)("article",{className:(0,j.default)("rounded-2xl border px-4 py-3",a.tone,"flex items-center gap-3 text-sm font-semibold"),children:[(0,b.jsx)(c,{size:18,className:a.accent}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-500",children:a.label}),(0,b.jsx)("p",{className:(0,j.default)("text-2xl",a.accent),children:a.value})]})]},a.label)})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("section",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("p",{className:"font-semibold text-slate-900",children:"Delivery timeline"}),(0,b.jsx)("span",{className:"text-xs text-slate-500",children:"Next 7 days"})]}),(0,b.jsx)("div",{className:"mt-3 space-y-3",children:g.length||f.length?[...f,...g].slice(0,4).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-slate-900",children:a.name}),(0,b.jsxs)("p",{className:"text-xs text-slate-500",children:["Due ",(a=>{if(!a)return"No due date";try{return new Intl.DateTimeFormat("en",{month:"short",day:"numeric"}).format(new Date(a))}catch(a){return"No due date"}})(a.dueDate)]})]}),(0,b.jsxs)("span",{className:"text-xs font-semibold text-slate-500",children:[a.taskSummary?.completed||0,"/",a.taskSummary?.total||0," tasks"]})]},a._id)):(0,b.jsx)("p",{className:"rounded-xl border border-dashed border-slate-300 px-3 py-4 text-center text-sm text-slate-500",children:"All upcoming deadlines are on track."})})]}),(0,b.jsxs)("section",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("p",{className:"font-semibold text-slate-900",children:"Capacity watchlist"}),(0,b.jsx)("span",{className:"text-xs text-slate-500",children:"Target < 90%"})]}),(0,b.jsx)("div",{className:"mt-3 space-y-3",children:h.length?h.slice(0,4).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-slate-900",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:a.role})]}),(0,b.jsxs)("span",{className:"rounded-full bg-rose-100 px-3 py-1 text-xs font-semibold text-rose-600",children:[a.computedWorkload,"% load"]})]},a._id)):(0,b.jsx)("p",{className:"rounded-xl border border-dashed border-slate-300 px-3 py-4 text-center text-sm text-slate-500",children:"No team members are over capacity."})})]})]})]})}var s=a.i(45227);function t(){let[a,e]=(0,c.useState)(null);const{projects:f,teamMembers:g,loading:h,projectSyncing:i,handleProjectCreate:j,handleProjectDelete:k,handleProgressUpdate:l,handleProjectHydrate:o,refreshTeam:p,handleTeamCreate:q}=(0,s.default)();(0,c.useEffect)(()=>{if(!f.length){null!==a&&e(null);return}f.some(b=>b._id===a)||e(f[0]._id)},[f,a]);const t=async a=>{let b=await j(a);e(b?._id??null)},u=async a=>{await k(a)},v=q;let w=(0,c.useMemo)(()=>f.length?f.find(b=>b._id===a)??f[0]:null,[f,a]),x=(0,c.useMemo)(()=>{let a=f.length,b=f.filter(a=>"Completed"===a.status).length,c=f.reduce((a,b)=>a+(b.taskSummary?.total||0),0),d=Date.now(),e=d+6048e5;return{totalProjects:a,active:a-b,completed:b,tasks:c,dueSoon:f.filter(a=>{if(!a?.dueDate||"Completed"===a.status)return!1;let b=new Date(a.dueDate).getTime();return b>=d&&b<=e}).length,studios:new Set(f.map(a=>a.studio).filter(Boolean)).size}},[f]),y=(0,c.useMemo)(()=>[{label:"Projects",value:x.totalProjects,caption:"Total in studio"},{label:"Active",value:x.active,caption:"Currently in delivery"},{label:"Completed",value:x.completed,caption:"Shipped this quarter"},{label:"Due this week",value:x.dueSoon,caption:"Need follow-up"}],[x]);const t=async a=>{let b=normalizeProject(await api.createProject(a));setProjects(a=>[b,...a]),e(b._id)},u=async b=>{let c=f.find(a=>a._id===b);if(!c||!window.confirm(`Delete ${c.name}? Tasks for this project will also be removed.`))return;await api.deleteProject(b);let d=a===b;setProjects(a=>{let c=a.filter(a=>a._id!==b);return d&&e(c[0]?._id??null),c})},l=async(a,b)=>{setProjectSyncing(b=>{let c=new Set(b);return c.add(a),c});try{let c=await api.updateProjectProgress(a,b);setProjects(b=>b.map(b=>b._id===a?normalizeProject({...b,...c}):b))}finally{setProjectSyncing(b=>{let c=new Set(b);return c.delete(a),c})}},o=a=>{a&&setProjects(b=>b.map(b=>b._id===a._id?normalizeProject(a):b))},p=async()=>{setTeamMembers(await api.getTeamMembers())},v=async a=>{await api.createTeamMember(a),await p()};return h?(0,b.jsx)("main",{className:"flex min-h-screen items-center justify-center text-slate-400",children:(0,b.jsxs)("div",{className:"space-y-2 text-center",children:[(0,b.jsx)("p",{className:"text-sm uppercase tracking-[0.3em]",children:"Loading studio"}),(0,b.jsx)("div",{className:"h-1 w-40 overflow-hidden rounded-full bg-white/10",children:(0,b.jsx)("div",{className:"h-full w-1/2 animate-pulse rounded-full bg-sky-400"})})]})}):(0,b.jsxs)("main",{className:"space-y-8",children:[(0,b.jsxs)("header",{className:"surface-card space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.35em] text-slate-400",children:"Dashboard"}),(0,b.jsx)("h1",{className:"mt-2 text-3xl font-semibold text-slate-900",children:"Arch studio overview"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Manage and track all your firmâ€™s projects, tasks, and teams in one calm workspace."})]}),(0,b.jsx)("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-4",children:y.map(a=>(0,b.jsxs)("article",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.35em] text-slate-400",children:a.label}),(0,b.jsx)("p",{className:"mt-2 text-2xl font-semibold text-slate-900",children:a.value??0}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:a.caption})]},a.label))})]}),(0,b.jsx)(d.default,{projects:f,selectedProjectId:a,onSelect:e,onCreate:t,onDelete:u,onProgressUpdate:l,busyProjectIds:i}),(0,b.jsxs)("section",{className:"grid gap-6 xl:grid-cols-[1.1fr_0.9fr]",children:[(0,b.jsx)(m,{project:w,teamMembers:g,onProjectUpdate:o,onTeamRefresh:p}),(0,b.jsx)(r,{projects:f,teamMembers:g})]}),(0,b.jsx)(n.default,{teamMembers:g,onCreate:v})]})}a.s(["default",()=>t],30100)}];

//# sourceMappingURL=app_page_b06da40b.js.map